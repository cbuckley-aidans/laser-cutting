<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Excel Gantt Chart Tutorial</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/inter-ui/3.19.3/inter.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/intro.js/6.0.0/intro.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/intro.js/6.0.0/introjs.min.css">
</head>
<body>
    <div class="tutorial-container">
        <!-- Left Sidebar Navigation -->
        <div class="sidebar">
            <div class="sidebar-logo">EXCEL<br>GANTT CHART</div>
            <div class="step-button active" data-step="0" data-tooltip="Introduction">
                <i class="fas fa-list-ol"></i>
            </div>
            <div class="step-button" data-step="1" data-tooltip="Opening Excel">
                <span>1</span>
            </div>
            <div class="step-button" data-step="2" data-tooltip="Creating the Chart">
                <span>2</span>
            </div>
        </div>

        <!-- Middle Instructions Panel -->
        <div class="instructions-panel">
            <h1 id="current-step-title">Introduction</h1>
            
            <div id="step-instructions">
                <!-- Will be populated by JavaScript -->
                <h3>Learning Intentions and Success Criteria</h3>
                
                <div class="card">
                    <p><strong>Learning Intention:</strong></p>
                    <ol class="steps-list">
                        <li>Learn how to create a simple Gantt chart in Microsoft Excel</li>
                    </ol>
                
                    <p><strong>Success Criteria:</strong></p>
                    <ol class="steps-list">
                        <li>Successfully create a visual timeline for project tasks using Excel's formatting tools</li>
                    </ol>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="navigation">
                <button id="prevButton" class="nav-button" disabled><i class="fas fa-arrow-left"></i> Previous</button>
                <button id="nextButton" class="nav-button">Next <i class="fas fa-arrow-right"></i></button>
            </div>

            <!-- Progress Bar -->
            <div class="progress-container">
                <div class="progress-text">Progress: <span id="progress-percentage">0%</span></div>
                <div class="progress-bar">
                    <div class="progress" style="width: 0%;"></div>
                </div>
            </div>

            <div class="footer">
                Made with <span style="color: var(--accent-color);">â™¥</span> by <span id="creator-name">Buckley</span>
            </div>
        </div>

        <!-- Right Content Display Area -->
        <div class="content-display">
            <div class="card">
                <h2 id="content-title">Introduction</h2>
                <div id="media-content">
                    <!-- Will be populated by JavaScript -->
                    <div class="alert-box alert-info">
                        <p><strong>Tutorial Overview</strong></p>
                        <p>In this tutorial, you'll learn how to create a simple Gantt chart in Microsoft Excel. A Gantt chart is a visual project management tool that shows tasks and their timelines, making it easy to track project progress and deadlines.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for viewing images -->
    <div id="imageModal" class="modal">
        <span class="modal-close">&times;</span>
        <img id="modalImage" class="modal-content">
    </div>

    <script>
        // Tutorial content configuration
        // Define your step titles
        const stepTitles = [
            "Introduction",
            "Opening Excel",
            "Creating the Gantt Chart"
        ];

        // Define your step instructions (middle panel content)
        const stepInstructions = [
            // Step 0: Introduction
            `<h3>Introduction to Excel Gantt Charts</h3>
            
            <div class="card">
                <p><strong>Learning Intention:</strong></p>
                <ol class="steps-list">
                    <li>Learn how to create a simple Gantt chart in Microsoft Excel</li>
                </ol>
            
                <p><strong>Success Criteria:</strong></p>
                <ol class="steps-list">
                    <li>Successfully create a visual timeline for project tasks using Excel's formatting tools</li>
                </ol>
            </div>
            
            <div class="alert-box alert-info">
                <p><strong>What is a Gantt Chart?</strong></p>
                <p>A Gantt chart is a horizontal bar chart that illustrates a project schedule. It shows the start and finish dates of tasks, making it an excellent tool for project planning and tracking progress.</p>
            </div>`,
            
            // Step 1: Opening Excel
            `<h3>Opening Excel and Creating a Blank Workbook</h3>
            <p>First, we need to open Microsoft Excel and create a new blank workbook to work with.</p>
            
            <div class="card">
                <h4>Steps to Open Excel:</h4>
                <ol class="steps-list">
                    <li>Press the <strong>Windows key</strong> on your keyboard to open the Start menu</li>
                    <li>Type <strong>"Excel"</strong> to search for the application</li>
                    <li>Click on <strong>Microsoft Excel</strong> when it appears in the search results</li>
                    <li>Once Excel opens, select <strong>"Blank workbook"</strong> to create a new file</li>
                </ol>
            </div>`,
            
            // Step 2: Creating the Gantt Chart
            `<h3>Creating the Gantt Chart</h3>
            <p>Now we'll create the structure for our Gantt chart and use Excel's formatting tools to visualise the timeline.</p>
            
            <div class="card">
                <h4>Setting Up the Chart:</h4>
                <ol class="steps-list">
                    <li>In cell <strong>A1</strong>, type "Task"</li>
                    <li>In cell <strong>B1</strong>, type "Week 1"</li>
                    <li>Select cell <strong>B1</strong> and drag the autofill handle (small square in the bottom-right corner) across to column <strong>K</strong> to create weeks 1-10</li>
                    <li>In column A (starting from <strong>A2</strong>), enter your assessment tasks or project milestones</li>
                    <li>Select the cells where you want to show task duration and use the <strong>Fill Colour</strong> button (bucket icon) in the toolbar to colour them in</li>
                    <li>Choose different colours for different types of tasks or phases of your project</li>
                </ol>
            </div>
            
            <div class="tip-box">
                <div class="tip-title"><i class="fas fa-lightbulb"></i> Pro Tips</div>
                <p>Use consistent colours for similar types of tasks. For example, use blue for research tasks, green for writing tasks, and red for deadlines. This makes your Gantt chart easier to read at a glance.</p>
            </div>`
        ];

        // Define your media content (right panel)
        const stepMedia = [
            // Step 0: Introduction
            `<div class="alert-box alert-info">
                <p><strong>Excel Gantt Chart Tutorial</strong></p>
                <p>This tutorial will teach you how to create a simple but effective Gantt chart using Microsoft Excel.</p>
            </div>
            
            <div class="image-container">
                <img src="https://i.imgur.com/g3baMym.png" alt="Example of a finished Gantt chart in Excel" class="cursor-pointer" style="max-width: 100%; height: auto; border-radius: var(--border-radius);">
                <div class="zoom-hint"><i class="fas fa-search-plus"></i> Click to zoom</div>
            </div>
            
            <p style="text-align: center; margin-top: 15px; font-style: italic;">Example of a finished Gantt chart showing project tasks and timelines</p>`,
            
            // Step 1: Opening Excel
            `<div class="video-container">
                <video width="100%" controls autoplay loop muted playsinline>
                    <source src="https://i.imgur.com/19s4dOZ.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>`,
            
            // Step 2: Creating the Gantt Chart
            `<div class="video-container">
                <video width="100%" controls autoplay loop muted playsinline>
                    <source src="https://i.imgur.com/aDOpYv9.mp4" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>`
        ];

        // Current step tracking
        let currentStep = 0;
        const totalSteps = stepInstructions.length;

        // DOM Elements
        const stepButtons = document.querySelectorAll('.step-button');
        const stepTitleEl = document.getElementById('current-step-title');
        const instructionsPanel = document.getElementById('step-instructions');
        const mediaContent = document.getElementById('media-content');
        const contentTitle = document.getElementById('content-title');
        const prevButton = document.getElementById('prevButton');
        const nextButton = document.getElementById('nextButton');
        const progressBar = document.querySelector('.progress');
        const progressPercentage = document.getElementById('progress-percentage');

        // Image modal
        const modal = document.getElementById('imageModal');
        const modalImg = document.getElementById('modalImage');
        const modalClose = document.querySelector('.modal-close');

        // Initialize the tutorial
        function showStep(step) {
            // Update active step button
            stepButtons.forEach((button, index) => {
                button.classList.toggle('active', index === step);
            });

            // Update step title
            stepTitleEl.textContent = stepTitles[step];
            contentTitle.textContent = stepTitles[step];

            // Update content
            instructionsPanel.innerHTML = stepInstructions[step];
            mediaContent.innerHTML = stepMedia[step];

            // Update navigation buttons
            prevButton.disabled = step === 0;
            nextButton.style.display = step === totalSteps - 1 ? 'none' : 'flex';
            
            // Update progress
            const progress = Math.round(((step + 1) / totalSteps) * 100);
            progressBar.style.width = `${progress}%`;
            progressPercentage.textContent = `${progress}%`;
            
            // Initialize carousels if present
            initCarousels();
            
            currentStep = step;
        }

        // Initialize all carousels on the page
        function initCarousels() {
            // Find all carousel elements in the current step
            document.querySelectorAll('.carousel').forEach((carouselElement) => {
                const carouselContainer = carouselElement.querySelector('.carousel-container');
                if (!carouselContainer) return;
                
                const slides = carouselContainer.querySelectorAll('.carousel-slide');
                if (slides.length <= 1) return;
                
                // Get carousel controls
                const prevBtn = carouselElement.querySelector('.prev-btn');
                const nextBtn = carouselElement.querySelector('.next-btn');
                const indicators = carouselElement.querySelector('.carousel-indicators');
                
                if (!prevBtn || !nextBtn || !indicators) return;
                
                // Clear existing indicators and recreate them
                indicators.innerHTML = '';
                slides.forEach((_, i) => {
                    const indicator = document.createElement('div');
                    indicator.className = `carousel-indicator ${i === 0 ? 'active' : ''}`;
                    indicator.dataset.index = i;
                    indicator.addEventListener('click', () => {
                        scrollToSlide(carouselContainer, indicators, i);
                    });
                    indicators.appendChild(indicator);
                });
                
                // Track the current slide for this carousel
                carouselContainer.dataset.currentSlide = '0';
                
                // Add click handlers to navigation buttons
                prevBtn.onclick = function() {
                    const currentSlide = parseInt(carouselContainer.dataset.currentSlide || '0');
                    const newSlide = (currentSlide - 1 + slides.length) % slides.length;
                    scrollToSlide(carouselContainer, indicators, newSlide);
                    carouselContainer.dataset.currentSlide = newSlide.toString();
                };
                
                nextBtn.onclick = function() {
                    const currentSlide = parseInt(carouselContainer.dataset.currentSlide || '0');
                    const newSlide = (currentSlide + 1) % slides.length;
                    scrollToSlide(carouselContainer, indicators, newSlide);
                    carouselContainer.dataset.currentSlide = newSlide.toString();
                };
            });
        }

        // Scroll carousel to specific slide
        function scrollToSlide(carousel, indicators, index) {
            // Calculate the scroll position
            const slideWidth = carousel.clientWidth;
            const scrollPosition = slideWidth * index;
            
            // Animate the scroll
            carousel.scrollTo({
                left: scrollPosition,
                behavior: 'smooth'
            });
            
            // Update indicators
            const allIndicators = indicators.querySelectorAll('.carousel-indicator');
            allIndicators.forEach((ind, i) => {
                ind.classList.toggle('active', i === index);
            });
        }

        // Simple tooltip implementation
        function setupTooltips() {
            // Remove any existing tooltips
            const existingTooltips = document.querySelectorAll('.tooltip');
            existingTooltips.forEach(t => t.remove());
            
            // Create new tooltip element
            const tooltip = document.createElement('div');
            tooltip.className = 'tooltip';
            document.body.appendChild(tooltip);
            
            // Add event listeners to all step buttons
            const stepButtons = document.querySelectorAll('.step-button');
            stepButtons.forEach(button => {
                const tooltipText = button.getAttribute('data-tooltip');
                if (!tooltipText) return;
                
                // On mouse enter
                button.addEventListener('mouseenter', () => {
                    // Set tooltip text
                    tooltip.textContent = tooltipText;
                    
                    // Position tooltip based on viewport width
                    const rect = button.getBoundingClientRect();
                    if (window.innerWidth <= 1024) {
                        // Position below on mobile
                        tooltip.className = 'tooltip bottom';
                        tooltip.style.top = `${rect.bottom + 10}px`;
                        tooltip.style.left = `${rect.left + rect.width/2}px`;
                        tooltip.style.transform = 'translateX(-50%)';
                    } else {
                        // Position to the right on desktop
                        tooltip.className = 'tooltip right';
                        tooltip.style.top = `${rect.top + rect.height/2}px`;
                        tooltip.style.left = `${rect.right + 10}px`;
                        tooltip.style.transform = 'translateY(-50%)';
                    }
                    
                    // Make tooltip visible
                    tooltip.style.opacity = '1';
                });
                
                // On mouse leave
                button.addEventListener('mouseleave', () => {
                    tooltip.style.opacity = '0';
                });
            });
        }

        // Event Listeners
        stepButtons.forEach((button, index) => {
            button.addEventListener('click', () => showStep(index));
        });

        prevButton.addEventListener('click', () => {
            if (currentStep > 0) showStep(currentStep - 1);
        });

        nextButton.addEventListener('click', () => {
            if (currentStep < totalSteps - 1) showStep(currentStep + 1);
        });

        // Image modal functionality
        document.addEventListener('click', (e) => {
            if (e.target.tagName === 'IMG' && e.target.parentElement.classList.contains('image-container')) {
                modal.style.display = 'block';
                modalImg.src = e.target.src;
                modalImg.alt = e.target.alt;
            }
        });

        modalClose.addEventListener('click', () => {
            modal.style.display = 'none';
        });

        modal.addEventListener('click', (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && modal.style.display === 'block') {
                modal.style.display = 'none';
            }
        });

        // Creator name with confetti
        document.getElementById('creator-name').addEventListener('click', () => {
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.8 },
                colors: ['#002654', '#f7f7f7', '#f0f0f0', '#191919']
            });
        });

        // Initialize with first step and set up tooltips
        document.addEventListener('DOMContentLoaded', () => {
            showStep(0);
            setupTooltips();
            
            // Update tooltips on window resize
            window.addEventListener('resize', () => {
                setupTooltips();
            });
            
            // Update tooltips whenever a step button is clicked
            document.querySelectorAll('.step-button').forEach(button => {
                button.addEventListener('click', () => {
                    setTimeout(setupTooltips, 100);
                });
            });
        });
    </script>
</body>
</html>